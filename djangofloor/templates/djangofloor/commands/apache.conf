<VirtualHost *:{{ SERVER_PORT }}>
    ServerName          {{ SERVER_NAME }}
    ServerAdmin {{ DEFAULT_FROM_EMAIL }}

    Alias               {{ STATIC_URL }}    {{ STATIC_ROOT }}
    Alias               {{ MEDIA_URL }}     {{ MEDIA_ROOT }}
    ProxyPass           {{ STATIC_URL }}    !
    ProxyPass           {{ MEDIA_URL }}     !
    ProxyPass           /           http://{{ LISTEN_ADDRESS }}/
    ProxyPassReverse    /           http://{{ LISTEN_ADDRESS }}/
    DocumentRoot        {{ STATIC_ROOT }}
    ServerSignature     off
    <Location {{ MEDIA_URL }}>
        Require all granted
    </Location>
    <Location {{ STATIC_URL }}>
        Require all granted
    </Location>
    <Location {{ WEBSOCKET_URL }}>
    </Location>
    <Location {{ URL_PREFIX }}>
    	{% if USE_HTTP_BASIC_AUTH %}# mod_auth_basic
        AuthType basic
        AuthName "{{ PROJECT_NAME }}"
        Require valid-user
    	{% endif %}# mod_proxy and mod_proxy_http
        ProxyAddHeaders On
        {% if USE_SSL %}RequestHeader set X-Forwarded-Proto 'https' env=HTTPS
        {% endif %}{% if USE_X_SEND_FILE %}
        {% endif %}
    </Location>

</VirtualHost>
